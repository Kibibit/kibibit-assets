<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>OpenAI Status (Unofficial)</title>
  <style>
    :root {
      --yellow-bg: #fff8e5;
      --yellow-border: #f4d98c;
      --yellow-text: #8a6d1f;
      --gray: #666;
      --light-border: #eee;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: #fff;
      color: #111;
      max-width: 720px;
      margin: 2rem auto;
      padding: 0 1rem;
      line-height: 1.5;
    }

    h2, h3 { margin: 1rem 0 .5rem; font-weight: 600; }

    /* Banner */
    .banner {
      background: var(--yellow-bg);
      border: 1px solid var(--yellow-border);
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin-bottom: 2rem;
    }
    .banner h2 {
      margin: 0 0 .5rem;
      font-size: 1rem;
      color: var(--yellow-text);
      font-weight: 600;
    }

    /* Incident list */
    .incidents { list-style: none; padding: 0; margin: 0; }
    .incidents li {
      display: flex;
      align-items: flex-start;
      padding: .75rem 0;
      border-bottom: 1px solid var(--light-border);
    }
    .bar {
      width: 6px;
      border-radius: 3px;
      margin-right: .75rem;
      flex-shrink: 0;
      align-self: normal;
    }
    .incidents a {
      color: #0056b3;
      font-weight: 500;
      text-decoration: none;
    }
    .incidents a:hover { text-decoration: underline; }
    .date {
      display: block;
      font-size: .8rem;
      color: var(--gray);
      margin-top: .25rem;
    }

    /* Severity colors */
    .ok    { background: #2ecc71; } /* green */
    .minor { background: #f1c40f; } /* yellow */
    .major { background: #e67e22; } /* orange */
    .critical { background: #e74c3c; } /* red */
    .info  { background: #3498db; } /* blue */
  </style>
</head>
<body>
  <div class="banner" id="current">
    Loading current status…
  </div>

  <h3>Recent Incidents</h3>
  <ul class="incidents" id="history"></ul>

  <script>
    function getSeverityClass(text) {
      const t = text.toLowerCase();
      if (t.includes("degraded") || t.includes("elevated")) return "minor";
      if (t.includes("partial") || t.includes("outage")) return "major";
      if (t.includes("critical") || t.includes("not displaying") || t.includes("down")) return "critical";
      if (t.includes("maintenance")) return "info";
      if (t.includes("resolved") || t.includes("recovered")) return "ok";
      return "minor"; // default
    }

    async function loadStatus() {
      const feedUrl = "https://status.openai.com/feed.rss";
      const proxied = "https://api.allorigins.win/raw?url=" + encodeURIComponent(feedUrl);

      const xmlText = await (await fetch(proxied)).text();
      const parser = new DOMParser();
      const xml = parser.parseFromString(xmlText, "application/xml");
      const items = Array.from(xml.querySelectorAll("item"));

      if (!items.length) {
        document.getElementById("current").innerText = "Could not load status.";
        return;
      }

      // First item as banner
      const latest = items[0];
      const title = latest.querySelector("title").textContent;
      const desc = latest.querySelector("description").textContent;
      document.getElementById("current").innerHTML = `
        <h2>We’re currently experiencing issues</h2>
        <strong>${title}</strong>
        <div>${desc}</div>
      `;

      // History with severity bars
      const list = document.getElementById("history");
      items.slice(0, 8).forEach(item => {
        const title = item.querySelector("title").textContent;
        const link = item.querySelector("link").textContent;
        const desc = item.querySelector("description").textContent;
        const date = new Date(item.querySelector("pubDate").textContent).toLocaleString();
        const severity = getSeverityClass(title + " " + desc);
        list.innerHTML += `
          <li>
            <div class="bar ${severity}"></div>
            <div>
              <a href="${link}" target="_blank">${title}</a>
              <span class="date">${date}</span>
            </div>
          </li>`;
      });
    }

    loadStatus();
  </script>
</body>
</html>
